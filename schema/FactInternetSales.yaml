cubes:
  - name: FactInternetSales
    sql: SELECT * FROM dbo."FactInternetSales"
    # preAggregations:
    #   - name: test
    #     measures:
    #       - FactInternetSales.sales_amount
    #     timeDimension: FactInternetSales.order_date
    #     granularity: year
    measures:

      - name: sales_amount_last_year
        sql: '{CUBE}."SalesAmount"'
        type: sum
        rolling_window:
          trailing: 1 year
          offset: start

      - name: order_quantity_last_year
        sql: '{CUBE}."OrderQuantity"'
        type: sum
        rolling_window:
          trailing: 1 year
          offset: start

      - name: average_unit_price
        sql: '{CUBE}."SalesAmount" / {CUBE}."OrderQuantity"'
        type: avg

      - name: average_unit_price_last_year
        sql: '{CUBE}."SalesAmount" / {CUBE}."OrderQuantity"'
        type: avg
        rolling_window:
          trailing: 1 year
          offset: start

      - name: count
        type: count
        drillMembers:
          - order_date
          - due_date
          - ship_date
      - name: sales_order_line_number
        sql: '{CUBE}."SalesOrderLineNumber"'
        type: number
      - name: revision_number
        sql: '{CUBE}."RevisionNumber"'
        type: number
      - name: order_quantity
        sql: '{CUBE}."OrderQuantity"'
        type: sum
      - name: unit_price
        sql: '{CUBE}."UnitPrice"'
        type: number
      - name: extended_amount
        sql: '{CUBE}."ExtendedAmount"'
        type: number
      - name: unitpricediscountpct
        sql: '{CUBE}."UnitPriceDiscountPct"'
        type: number
      - name: discount_amount
        sql: '{CUBE}."DiscountAmount"'
        type: number
      - name: product_standard_cost
        sql: '{CUBE}."ProductStandardCost"'
        type: number
      - name: total_product_cost
        sql: '{CUBE}."TotalProductCost"'
        type: number
      - name: sales_amount
        sql: '{CUBE}."SalesAmount"'
        type: sum
      - name: tax_amt
        sql: '{CUBE}."TaxAmt"'
        type: number
      - name: freight
        sql: '{CUBE}."Freight"'
        type: number
    dimensions:
      - name: product_key
        sql: '{CUBE}."ProductKey"'
        type: number
      - name: order_date_key
        sql: '{CUBE}."OrderDateKey"'
        type: number
      - name: due_date_key
        sql: '{CUBE}."DueDateKey"'
        type: number
      - name: shipdate_key
        sql: '{CUBE}."ShipDateKey"'
        type: number
      - name: customer_key
        sql: '{CUBE}."CustomerKey"'
        type: number
      - name: promotion_key
        sql: '{CUBE}."PromotionKey"'
        type: number
      - name: currency_key
        sql: '{CUBE}."CurrencyKey"'
        type: number
      - name: sales_territory_key
        sql: '{CUBE}."SalesTerritoryKey"'
        type: number
      - name: sales_order_number
        sql: '{CUBE}."SalesOrderNumber"'
        type: string
        primaryKey: true
      - name: carrier_tracking_number
        sql: '{CUBE}."CarrierTrackingNumber"'
        type: string
      - name: customer_po_number
        sql: '{CUBE}."CustomerPONumber"'
        type: string
      - name: order_date
        sql: '{CUBE}."OrderDate"'
        type: time
      - name: due_date
        sql: '{CUBE}."DueDate"'
        type: time
      - name: ship_date
        sql: '{CUBE}."ShipDate"'
        type: time
